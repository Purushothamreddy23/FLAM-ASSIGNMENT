# FLAM-ASSIGNMENT
Assignment for Research and Development / AI

# Parametric Curve Fitting Solution

## Problem Statement

Find the optimal values of unknown variables (θ, M, X) in the parametric equations:

```
x(t) = t·cos(θ) - e^(M|t|)·sin(0.3t)·sin(θ) + X
y(t) = 42 + t·sin(θ) + e^(M|t|)·sin(0.3t)·cos(θ)
```

**Constraints:**
- 0° < θ < 50°
- -0.05 < M < 0.05
- 0 < X < 100
- 6 < t < 60

**Data:** 1,500 (x, y) coordinate pairs that lie on the curve for t ∈ [6, 60]

---

## Solution

#### **Optimal Parameter Values:**

| Parameter | Value (Radians/Units) | Value (Degrees) |
|-----------|----------------------|-----------------|
| **θ** | 0.523613 rad | 30.0008° |
| **M** | 0.030000 | - |
| **X** | 55.0007 | - |

#### **Performance Metrics:**
- **Total L1 Distance:** 48.1220
- **Average Distance per Point:** 0.0321
- **Maximum Distance:** 0.0953
- **Standard Deviation:** 0.0197

---

### LaTeX Format (Full Precision):
```latex
\left(t*\cos(0.523613)-e^{0.030000\left|t\right|}\cdot\sin(0.3t)\sin(0.523613)\ +55.0007,42+\ t*\sin(0.523613)+e^{0.030000\left|t\right|}\cdot\sin(0.3t)\cos(0.523613)\right)
```

### Desmos Format (Rounded for Display):
```latex
\left(t*\cos(0.5236)-e^{0.0300\left|t\right|}\cdot\sin(0.3t)\sin(0.5236)\ +55.00,42+\ t*\sin(0.5236)+e^{0.0300\left|t\right|}\cdot\sin(0.3t)\cos(0.5236)\right)
```

Then set the domain: `6 ≤ t ≤ 60`

---

## Methodology

### 1. Problem Analysis

The parametric curve consists of:
- **Linear component:** `t·cos(θ)` and `t·sin(θ)` create the primary linear trend
- **Exponential modulation:** `e^(M|t|)·sin(0.3t)` adds oscillating behavior that grows/decays with t
- **Translation:** X shifts the curve horizontally, 42 shifts it vertically

**Key Challenge:** We have (x, y) data points but don't know which t value generated each point.

### 2. Solution Approach

#### **Strategy: Distance Minimization**

Since we don't have explicit t-to-point mapping, we use a distance-based approach:

1. **Generate candidate curve:** For given parameters (θ, M, X), sample the curve densely over t ∈ [6, 60]
2. **Compute distances:** For each data point, find the minimum distance to any point on the candidate curve
3. **Optimize:** Minimize the sum of these minimum distances (L1 norm)

#### **Optimization Method: Differential Evolution**

- **Algorithm:** Differential Evolution (DE) - a global optimization method ideal for non-convex problems
- **Why DE?** 
  - Robust to local minima
  - Handles non-linear, non-differentiable objectives
  - Doesn't require gradient information
  - Explores the parameter space effectively

**Configuration:**
```python
bounds = [
    (0, 0.873),      # θ in [0°, 50°] → [0, 0.873 rad]
    (-0.05, 0.05),   # M
    (0, 100)         # X
]

differential_evolution(
    objective_function,
    bounds=bounds,
    maxiter=300,
    popsize=20,
    polish=True  # Local refinement at the end
)
```

### 3. Mathematical Details

#### **Objective Function**

```python
def objective_function(θ, M, X):
    # Generate dense curve sampling
    t_samples = linspace(6, 60, 500)
    x_curve, y_curve = parametric_curve(t_samples, θ, M, X)
    
    # For each data point, find minimum distance to curve
    total_distance = 0
    for (x_i, y_i) in data_points:
        distances = sqrt((x_curve - x_i)² + (y_curve - y_i)²)
        total_distance += min(distances)
    
    return total_distance
```

#### **Why This Works**

- Each data point was generated by the true curve at some unknown t*
- The closest point on our candidate curve to each data point should ideally be at that same t*
- By minimizing total distance, we find parameters where the candidate curve passes through or very near all data points

### 4. Validation

#### **Residual Analysis**
- Mean residual: 0.0321 units
- 99.9% of points within 0.10 units of the fitted curve
- Residuals follow approximately normal distribution

#### **Visual Verification**
Generated visualizations show:
1. Data points align closely with fitted curve
2. Minimal systematic bias in residuals
3. Smooth, continuous fitted curve

---

## Sensitivity Analysis

The solution is robust to small parameter variations:

| Variation | θ Impact | M Impact | X Impact |
|-----------|----------|----------|----------|
| ±1% | High | Moderate | Very High |
| ±5% | Very High | High | Extreme |

**Key Findings:**
- **X is most sensitive** - Small changes dramatically increase error
- **θ is highly sensitive** - The angle is critical for curve orientation
- **M is moderately sensitive** - Controls exponential growth rate

This sensitivity pattern confirms:
1. The optimization found a sharp minimum (good convergence)
2. All three parameters are necessary (none are redundant)
3. The solution is well-constrained by the data

---

## Code Structure

### Files Included:

1. **`curve_fitting.py`** - Main optimization script
   - Data loading and preprocessing
   - Parametric curve implementation
   - Differential Evolution optimization
   - Result visualization and metrics

2. **`sensitivity_analysis.py`** - Parameter sensitivity analysis
   - 1D sensitivity plots for each parameter
   - 2D contour plots for parameter interactions
   - Quantitative sensitivity metrics
---

## Results Interpretation

### What the Parameters Mean:

1. **θ = 30.0008°**
   - Controls the orientation/rotation of the curve
   - Determines the ratio of t's contribution to x vs y
   - Nearly exactly 30° suggests inherent symmetry in the problem

2. **M = 0.030000**
   - Positive value → exponential growth with |t|
   - Creates increasing oscillation amplitude as t increases
   - Relatively small value keeps growth moderate

3. **X = 55.0007**
   - Horizontal translation of the entire curve
   - Shifts the x-coordinate by approximately 55 units
   - Combined with the y-offset of 42, centers the curve

### Curve Characteristics:

- **Base trajectory:** Approximately linear with slope determined by θ
- **Superimposed oscillation:** Period ≈ 2π/0.3 ≈ 20.94 units in t
- **Growing amplitude:** Oscillations grow exponentially with rate M
- **Overall shape:** Spiral-like structure in (x, y) space

---

## Verification Steps

To verify this solution:

1. **Desmos Verification:**
   - Visit: https://www.desmos.com/calculator
   - Paste the Desmos format equation
   - Set domain: 6 ≤ t ≤ 60
   - The curve should match the provided screenshot

2. **Numerical Verification:**
   ```python
   # Test with specific t values
   t_test = [6, 20, 40, 60]
   for t in t_test:
       x, y = parametric_curve(t, 0.523613, 0.030000, 55.0007)
       print(f"t={t}: ({x:.2f}, {y:.2f})")
   ```

3. **Statistical Verification:**
   - Load provided xy_data.csv
   - Generate fitted curve with optimal parameters
   - Confirm average distance < 0.05 units

---

## Conclusion

The optimization successfully identified parameter values that produce a curve fitting the 1,500 data points with:
- **High accuracy:** Average distance of 0.032 units
- **Physical plausibility:** All parameters within specified bounds
- **Mathematical consistency:** Smooth, continuous curve
- **Statistical robustness:** Low variance in residuals

The solution demonstrates effective application of global optimization techniques to inverse parametric curve problems where the parameter-to-data mapping is unknown.

---

---

## References

- Storn, R., & Price, K. (1997). Differential evolution–a simple and efficient heuristic for global optimization over continuous spaces. Journal of global optimization, 11(4), 341-359.
- Parametric curve fitting techniques in numerical optimization
- L1 distance metric for curve matching
